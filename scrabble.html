<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrabble Românico</title>
    <link rel="stylesheet" href="styles.css">
    <script>

function normalizeDictionary(dictionary) {
    return dictionary.map(word =>
        word.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase()
    );
}

const dictionaries = {};
for (const [language, words] of Object.entries(rawDictionaries)) {
    dictionaries[language] = normalizeDictionary(words);
}
const scores = {
    A: 1, B: 3, C: 3, Ç: 5, D: 2, E: 1, F: 4, G: 2,
    H: 4, I: 1, J: 8, K: 10, L: 1, M: 3, N: 1, Ñ: 8,
    O: 1, P: 3, Q: 10, R: 1, S: 1, T: 1, U: 1, V: 4,
    W: 10, X: 8, Y: 10, Z: 10
};

function calculateScore(word) {
    const normalizedWord = word.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g, ""); // Normalizar e remover acentos
    let score = 0;

    for (const letter of normalizedWord) {
        score += scores[letter] || 0; // Somar pontuação da letra, ou 0 se não for válida
    }

    return score;
}

function displayScore(word) {
    if (!word.trim()) {
        document.getElementById("scoreResult").textContent = "Por favor, insira uma palavra.";
        return;
    }

    const score = calculateScore(word);
    document.getElementById("scoreResult").textContent =
        `A pontuação da palavra "${word}" é: ${score}.`;
}


async function checkWordLanguages(word) {
    const url = `https://fr.wiktionary.org/w/api.php?action=query&titles=${encodeURIComponent(
        word
    )}&prop=extracts&explaintext=true&format=json&origin=*`;

    try {
        const response = await fetch(url);
        if (response.ok) {
            const data = await response.json();
            const pages = data.query.pages;
            const page = Object.values(pages)[0];

            if (!page || page.missing) {
                document.getElementById("validationResult").textContent =
                    `A palavra "${word}" não foi encontrada no Wiktionnaire.`;
                return;
            }

            const extract = page.extract || "";
            const languageMatches = extract.match(/^==\s*([^\=]+)\s*==$/gm) || [];
            const languages = languageMatches.map(match =>
                match.replace(/^==\s*|\s*==$/g, "").trim()
            );

            if (languages.length > 0) {
                document.getElementById("validationResult").textContent =
                    `A palavra "${word}" foi encontrada nas seguintes línguas: ${languages.join(", ")}.`;
            } else {
                document.getElementById("validationResult").textContent =
                    `Não foi possível identificar as línguas para a palavra "${word}".`;
            }
        } else {
            document.getElementById("validationResult").textContent =
                `Erro ao consultar o Wiktionnaire: ${response.statusText}`;
        }
    } catch (error) {
        document.getElementById("validationResult").textContent =
            `Erro ao consultar o Wiktionnaire: ${error.message}`;
    }
}


    </script>
</head>
<body>
    <h1>Scrabble Românico</h1>


    <form onsubmit="return false;">
        <label for="word">Digite uma palavra:</label>
        <input type="text" id="word" name="letters">
        <button type="button" onclick="checkWordLanguages(document.getElementById('word').value)">
            Identificar Línguas
        </button>
        <button type="button" onclick="displayScore(document.getElementById('word').value)">
            Calcular Pontuação
        </button>
    </form>
    
    <div>
        <h3>Resultado da Validação:</h3>
        <div id="validationResult"></div>
    </div>
    
    <div>
        <h3>Pontuação da Palavra:</h3>
        <div id="scoreResult"></div>
    </div>
    
    </div>
</body>
</html>
